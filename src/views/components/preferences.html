<!-- Job Preferences Section -->
<section id="preferences" class="d-none">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Job Preferences</h2>
        <button class="btn btn-primary" id="savePreferences">
            <i class="bi bi-save me-2"></i>Save Changes
        </button>
    </div>

    <div class="card mb-4">
        <div class="card-body">
            <form id="preferencesForm">
                <!-- Job Types -->
                <div class="mb-4">
                    <h5>Job Types</h5>
                    <div class="row g-3">
                        <div class="col-md-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="fullTime" checked>
                                <label class="form-check-label" for="fullTime">Full-time</label>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="contract">
                                <label class="form-check-label" for="contract">Contract</label>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="remote" checked>
                                <label class="form-check-label" for="remote">Remote</label>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="hybrid">
                                <label class="form-check-label" for="hybrid">Hybrid</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Location Preferences -->
                <div class="mb-4">
                    <h5>Location Preferences</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Preferred Locations</label>
                            <input type="text" class="form-control" placeholder="Add locations (comma-separated)">
                            <small class="text-muted">Example: New York, San Francisco, Austin</small>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Maximum Distance</label>
                            <select class="form-select">
                                <option value="10">Within 10 miles</option>
                                <option value="25">Within 25 miles</option>
                                <option value="50" selected>Within 50 miles</option>
                                <option value="100">Within 100 miles</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Salary Range -->
                <div class="mb-4">
                    <h5>Salary Range</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Minimum Salary</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" value="80000">
                                <span class="input-group-text">/year</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Maximum Salary</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" value="120000">
                                <span class="input-group-text">/year</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Keywords -->
                <div class="mb-4">
                    <h5>Keywords</h5>
                    <div class="row g-3">
                        <div class="col-md-12">
                            <label class="form-label">Must Include Keywords</label>
                            <input type="text" class="form-control" placeholder="Required keywords (comma-separated)">
                            <small class="text-muted">Example: Python, React, AWS</small>
                        </div>
                        <div class="col-md-12">
                            <label class="form-label">Exclude Keywords</label>
                            <input type="text" class="form-control" placeholder="Keywords to avoid (comma-separated)">
                            <small class="text-muted">Example: PHP, WordPress</small>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- Add this at the bottom of the file -->
<script type="module">
    import { 
        loadPreferences, 
        setupEventListeners,
        showNotification 
    } from '/js/preferences.js';

    // Debug log
    console.log('Preferences script loaded');

    // Initialize when section becomes visible
    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            // Debug log
            console.log('Mutation detected:', mutation.target.id, mutation.target.classList.contains('d-none'));
            
            // Check if preferences section is visible
            if (mutation.target.id === 'preferences' && !mutation.target.classList.contains('d-none')) {
                console.log('Loading preferences...');
                loadPreferences();
                setupEventListeners();
                showNotification('Preferences loaded');
            }
        });
    });

    // Get preferences section
    const preferencesSection = document.getElementById('preferences');
    
    if (preferencesSection) {
        // Debug log
        console.log('Starting observer on preferences section');
        
        // Start observing
        observer.observe(preferencesSection, { 
            attributes: true, 
            attributeFilter: ['class'] 
        });

        // If section is already visible, load preferences
        if (!preferencesSection.classList.contains('d-none')) {
            console.log('Preferences section already visible, loading...');
            loadPreferences();
            setupEventListeners();
        }
    } else {
        console.error('Preferences section not found');
    }
</script>
<script>
    console.log('hello world');
</script>
<!-- Toast Notifications -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="notification-toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <strong class="me-auto">Notification</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body"></div>
    </div>
</div>